<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title></title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="stylesheet" type="text/css" href="R.css" />
</head><body>

<table width="100%" summary="page for xEnrichBarplot"><tr><td>xEnrichBarplot</td><td style="text-align: right;">R Documentation</td></tr></table>

<h2>xEnrichBarplot</h2>

<h3>Usage</h3>

<pre>
xEnrichBarplot(eTerm, top_num = 10, displayBy = c("fc", "adjp", "fdr",
"zscore", "pvalue"), FDR.cutoff = 0.05, bar.label = TRUE,
bar.label.size = 3, wrap.width = NULL, signature = TRUE)
</pre>


<h3>Arguments</h3>

<table summary="R argblock">
<tr valign="top"><td><code>eTerm</code></td>
<td>


</td></tr>
<tr valign="top"><td><code>top_num</code></td>
<td>


</td></tr>
<tr valign="top"><td><code>displayBy</code></td>
<td>


</td></tr>
<tr valign="top"><td><code>FDR.cutoff</code></td>
<td>


</td></tr>
<tr valign="top"><td><code>bar.label</code></td>
<td>


</td></tr>
<tr valign="top"><td><code>bar.label.size</code></td>
<td>


</td></tr>
<tr valign="top"><td><code>wrap.width</code></td>
<td>


</td></tr>
<tr valign="top"><td><code>signature</code></td>
<td>


</td></tr>
</table>


<h3>Examples</h3>

<pre>
##---- Should be DIRECTLY executable !! ----
##-- ==&gt;  Define data, use random,
##--	or do  help(data=index)  for the standard data sets.

## The function is currently defined as
function (eTerm, top_num = 10, displayBy = c("fc", "adjp", "fdr",
"zscore", "pvalue"), FDR.cutoff = 0.05, bar.label = TRUE,
bar.label.size = 3, wrap.width = NULL, signature = TRUE)
{
displayBy &lt;- match.arg(displayBy)
if (is.logical(eTerm)) {
stop("There is no enrichment in the 'eTerm' object.\n")
}
df &lt;- xEnrichViewer(eTerm, top_num = "all")
if (top_num == "auto") {
top_num &lt;- sum(df$adjp &lt; FDR.cutoff)
if (top_num &lt;= 1) {
top_num &lt;- 10
}
}
df &lt;- xEnrichViewer(eTerm, top_num = top_num, sortBy = "adjp")
if (!is.null(wrap.width)) {
width &lt;- as.integer(wrap.width)
res_list &lt;- lapply(df$name, function(x) {
x &lt;- gsub("_", " ", x)
y &lt;- strwrap(x, width = width)
if (length(y) &gt; 1) {
paste0(y[1], "...")
}
else {
y
}
})
df$name &lt;- unlist(res_list)
}
name &lt;- height &lt;- NULL
if (displayBy == "adjp" | displayBy == "fdr") {
df &lt;- df[with(df, order(-adjp, zscore)), ]
df$name &lt;- factor(df$name, levels = df$name)
df$height &lt;- -1 * log10(df$adjp)
df$height[is.infinite(df$height)] &lt;-
max(df$height[!is.infinite(df$height)])
p &lt;- ggplot(df, aes(x = name, y = height))
p &lt;- p + ylab("Enrichment significance: -log10(FDR)")
}
else if (displayBy == "fc") {
df &lt;- df[with(df, order(fc, -adjp)), ]
df$name &lt;- factor(df$name, levels = df$name)
df$height &lt;- df$fc
p &lt;- ggplot(df, aes(x = name, y = height))
p &lt;- p + ylab("Enrichment changes")
}
else if (displayBy == "pvalue") {
df &lt;- df[with(df, order(-pvalue, zscore)), ]
df$name &lt;- factor(df$name, levels = df$name)
df$height &lt;- -1 * log10(df$pvalue)
df$height[is.infinite(df$height)] &lt;-
max(df$height[!is.infinite(df$height)])
p &lt;- ggplot(df, aes(x = name, y = height))
p &lt;- p + ylab("Enrichment significance: -log10(p-value)")
}
else if (displayBy == "zscore") {
df &lt;- df[with(df, order(zscore, -adjp)), ]
df$name &lt;- factor(df$name, levels = df$name)
df$height &lt;- df$zscore
p &lt;- ggplot(df, aes(x = name, y = height))
p &lt;- p + ylab("Enrichment z-scores")
}
bp &lt;- p + geom_col(aes(fill = height)) + scale_fill_gradient(low =
"lightyellow",
high = "orange") + theme_bw() + theme(legend.position = "none",
axis.title.y = element_blank(), axis.text.y = element_text(size = 12,
color = "black"), axis.title.x = element_text(size = 14,
color = "black")) + coord_flip()
if (bar.label) {
to_scientific_notation &lt;- function(x) {
res &lt;- format(x, scientific = T)
res &lt;- sub("\+0?", "", res)
sub("-0?", "-", res)
}
label &lt;- to_scientific_notation(df$adjp)
label &lt;- paste("FDR", as.character(label), sep = "=")
bp &lt;- bp + geom_text(aes(label = label), hjust = 1, size =
bar.label.size)
}
if (signature) {
caption &lt;- paste("Created by xEnrichBarplot from XGR version",
utils::packageVersion("XGR"))
bp &lt;- bp + labs(caption = caption) + theme(plot.caption =
element_text(hjust = 1,
face = "bold.italic", size = 8, colour = "#002147"))
}
bp &lt;- bp + theme(axis.line.x = element_line(arrow = arrow(angle = 30,
length = unit(0.25, "cm"), type = "open")))
bp &lt;- bp + scale_y_continuous(position = "top")
invisible(bp)
}
</pre>


</body></html>
